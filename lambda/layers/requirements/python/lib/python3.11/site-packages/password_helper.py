import bcrypt


# Guide: https://dev.to/kmistele/how-to-securely-hash-and-store-passwords-in-your-next-application-4e2f
def create_bcrypt_hash(password):
    password_bytes = password.encode()
    # generate a salt
    # TODO Look into right sizeingin salt rounds?
    salt = bcrypt.gensalt(10)
    # calculate a hash as bytes
    password_hash_bytes = bcrypt.hashpw(password_bytes, salt)
    # decode bytes to a string
    password_hash_str = password_hash_bytes.decode()

    # the password hash string should similar to:
    # $2b$10$//DXiVVE59p7G5k/4Klx/ezF7BI42QZKmoOD0NDvUuqxRE5bFFBLy
    return password_hash_str


def verify_password(password, hash_from_database):
    print(f"password: {password}. Hash: {hash_from_database}")
    password_bytes = password.encode()
    hash_bytes = hash_from_database.encode()

    # this will automatically retrieve the salt from the hash,
    # then combine it with the password (parameter 1)
    # and then hash that, and compare it to the user's hash
    does_match = bcrypt.checkpw(password_bytes, hash_bytes)
    print(f"match: {does_match}")

    return does_match
