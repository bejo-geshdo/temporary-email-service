import json


def generate_response(
    status_code: int,
    msg: str,
    body: dict = {},
    error: str = None,
    content_type: str = "application/json",
):
    response_body = {"msg": msg} | body
    if error:
        response_body["error"] = error
    response = {
        "statusCode": status_code,
        "headers": {
            "Content-Type": content_type,
            "Access-Control-Allow-Origin": "*",  # TODO lock down to our domain
            "Access-Control-Allow-Methods": "DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT",
            "Access-Control-Allow-Headers": "Content-Type,Authorization,X-Amz-Date,X-Api-Key,X-Amz-Security-Token",
        },
        "body": json.dumps(response_body, default=str),
    }
    return response


def respons(
    status_code: int, msg: str, body: dict = {}, content_type: str = "application/json"
):
    return generate_response(status_code, msg, body, content_type=content_type)


def respons_error(
    status_code: int,
    msg: str,
    error: str,
    body: dict = {},
    content_type="application/json",
):
    return generate_response(status_code, msg, body, error, content_type)
